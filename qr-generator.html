<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNO Restaurant & Café - QR Code Generator</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-color: #ff6b35;
            --secondary-color: #2c3e50;
            --success-color: #27ae60;
            --white: #ffffff;
            --light-gray: #f8f9fa;
            --dark-gray: #343a40;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem 0;
        }

        .container {
            max-width: 1200px;
        }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .card-header {
            background: linear-gradient(135deg, var(--primary-color), #e55a2b);
            color: var(--white);
            border-radius: 15px 15px 0 0;
            padding: 1.5rem;
        }

        .card-header h3 {
            margin: 0;
            font-weight: 600;
        }

        .card-body {
            padding: 2rem;
        }

        .qr-preview {
            background: var(--white);
            border: 2px dashed #ddd;
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .qr-code-container {
            background: var(--white);
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
        }

        .table-card {
            background: var(--white);
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .table-card:hover {
            transform: translateY(-5px);
        }

        .table-card.selected {
            border: 3px solid var(--primary-color);
            background: rgba(255, 107, 53, 0.05);
        }

        .table-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .table-url {
            font-size: 0.8rem;
            color: #666;
            word-break: break-all;
            margin-bottom: 1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), #e55a2b);
            border: none;
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
        }

        .btn-success {
            background: var(--success-color);
            border: none;
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
        }

        .form-control, .form-select {
            border-radius: 8px;
            border: 2px solid #e9ecef;
            padding: 0.75rem 1rem;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(255, 107, 53, 0.25);
        }

        .settings-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .qr-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }
            
            .card-body {
                padding: 1rem;
            }
            
            .qr-actions {
                flex-direction: column;
            }
            
            .table-number {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="text-center mb-4">
            <h1 class="text-white mb-2">
                <i class="fas fa-qrcode me-2"></i>
                UNO Restaurant QR Code Generator
            </h1>
            <p class="text-white-50">Generate QR codes for your restaurant tables</p>
        </div>

        <div class="row">
            <!-- Settings Panel -->
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-cog me-2"></i>Settings</h3>
                    </div>
                    <div class="card-body">
                        <!-- Base URL Settings -->
                        <div class="settings-section">
                            <h5 class="mb-3">Base URL</h5>
                            <div class="mb-3">
                                <label class="form-label">Menu URL</label>
                                <input type="text" class="form-control" id="baseUrl" 
                                       value="https://your-github-pages-url.github.io/uno-qr-menu/"
                                       placeholder="Enter your GitHub Pages URL">
                                <small class="text-muted">This will be the base URL for your menu</small>
                            </div>
                        </div>

                        <!-- Table Range Settings -->
                        <div class="settings-section">
                            <h5 class="mb-3">Table Range</h5>
                            <div class="row">
                                <div class="col-6">
                                    <label class="form-label">From Table</label>
                                    <input type="number" class="form-control" id="tableFrom" value="1" min="1">
                                </div>
                                <div class="col-6">
                                    <label class="form-label">To Table</label>
                                    <input type="number" class="form-control" id="tableTo" value="20" min="1">
                                </div>
                            </div>
                            <button class="btn btn-primary w-100 mt-3" onclick="generateTableList()">
                                <i class="fas fa-table me-2"></i>Generate Tables
                            </button>
                        </div>

                        <!-- QR Code Settings -->
                        <div class="settings-section">
                            <h5 class="mb-3">QR Code Settings</h5>
                            <div class="mb-3">
                                <label class="form-label">Size</label>
                                <select class="form-select" id="qrSize">
                                    <option value="200">Small (200x200)</option>
                                    <option value="300" selected>Medium (300x300)</option>
                                    <option value="400">Large (400x400)</option>
                                    <option value="500">Extra Large (500x500)</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Error Correction</label>
                                <select class="form-select" id="errorCorrection">
                                    <option value="L">Low (7%)</option>
                                    <option value="M" selected>Medium (15%)</option>
                                    <option value="Q">Quartile (25%)</option>
                                    <option value="H">High (30%)</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Foreground Color</label>
                                <input type="color" class="form-control" id="qrColor" value="#000000">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Background Color</label>
                                <input type="color" class="form-control" id="qrBackground" value="#ffffff">
                            </div>
                        </div>

                        <!-- Bulk Actions -->
                        <div class="settings-section">
                            <h5 class="mb-3">Bulk Actions</h5>
                            <button class="btn btn-success w-100 mb-2" onclick="downloadAllQRCodes()">
                                <i class="fas fa-download me-2"></i>Download All QR Codes
                            </button>
                            <button class="btn btn-primary w-100" onclick="printAllQRCodes()">
                                <i class="fas fa-print me-2"></i>Print All QR Codes
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tables Grid -->
            <div class="col-lg-5">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-table me-2"></i>Tables</h3>
                    </div>
                    <div class="card-body">
                        <div id="tablesGrid" class="row g-3">
                            <!-- Tables will be generated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- QR Code Preview -->
            <div class="col-lg-3">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-qrcode me-2"></i>QR Preview</h3>
                    </div>
                    <div class="card-body">
                        <div class="qr-preview" id="qrPreview">
                            <i class="fas fa-qrcode fa-3x text-muted mb-3"></i>
                            <p class="text-muted">Select a table to generate QR code</p>
                        </div>
                        
                        <div class="qr-actions" id="qrActions" style="display: none;">
                            <button class="btn btn-primary btn-sm" onclick="downloadQRCode()">
                                <i class="fas fa-download me-1"></i>Download
                            </button>
                            <button class="btn btn-success btn-sm" onclick="printQRCode()">
                                <i class="fas fa-print me-1"></i>Print
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="copyQRUrl()">
                                <i class="fas fa-copy me-1"></i>Copy URL
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Instructions -->
        <div class="card mt-4">
            <div class="card-header">
                <h3><i class="fas fa-info-circle me-2"></i>Instructions</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h5>How to Use:</h5>
                        <ol>
                            <li>Enter your GitHub Pages URL in the Base URL field</li>
                            <li>Set the table range (from and to table numbers)</li>
                            <li>Click "Generate Tables" to create the table list</li>
                            <li>Click on any table to generate its QR code</li>
                            <li>Download individual QR codes or all at once</li>
                            <li>Print QR codes for table placement</li>
                        </ol>
                    </div>
                    <div class="col-md-6">
                        <h5>QR Code Features:</h5>
                        <ul>
                            <li>Customizable size and colors</li>
                            <li>Error correction levels for durability</li>
                            <li>High-quality PNG format</li>
                            <li>Print-ready resolution</li>
                            <li>Unique URL for each table</li>
                            <li>Mobile-optimized menu interface</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- QR Generator Script -->
    <script>
        let currentTable = null;
        let currentQRCode = null;
        let allQRCodes = {};

        // Generate table list
        function generateTableList() {
            const from = parseInt(document.getElementById('tableFrom').value);
            const to = parseInt(document.getElementById('tableTo').value);
            const tablesGrid = document.getElementById('tablesGrid');

            if (from > to) {
                alert('From table number should be less than or equal to To table number');
                return;
            }

            tablesGrid.innerHTML = '';

            for (let i = from; i <= to; i++) {
                const tableCard = document.createElement('div');
                tableCard.className = 'col-6 col-md-4 col-lg-3';
                tableCard.innerHTML = `
                    <div class="table-card" onclick="selectTable(${i})">
                        <div class="table-number">${i}</div>
                        <div class="table-url">${getTableUrl(i)}</div>
                        <small class="text-muted">Click to generate QR</small>
                    </div>
                `;
                tablesGrid.appendChild(tableCard);
            }
        }

        // Get table URL
        function getTableUrl(tableNumber) {
            const baseUrl = document.getElementById('baseUrl').value.trim();
            const cleanUrl = baseUrl.endsWith('/') ? baseUrl : baseUrl + '/';
            return `${cleanUrl}?table=${tableNumber}`;
        }

        // Select table and generate QR code
        async function selectTable(tableNumber) {
            // Remove previous selection
            document.querySelectorAll('.table-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Add selection to current table
            event.target.closest('.table-card').classList.add('selected');

            currentTable = tableNumber;
            const url = getTableUrl(tableNumber);

            try {
                await generateQRCode(url, tableNumber);
            } catch (error) {
                console.error('Error generating QR code:', error);
                alert('Error generating QR code. Please try again.');
            }
        }

        // Generate QR code
        async function generateQRCode(url, tableNumber) {
            const qrPreview = document.getElementById('qrPreview');
            const qrActions = document.getElementById('qrActions');
            const size = parseInt(document.getElementById('qrSize').value);
            const errorCorrectionLevel = document.getElementById('errorCorrection').value;
            const color = {
                dark: document.getElementById('qrColor').value,
                light: document.getElementById('qrBackground').value
            };

            try {
                // Show loading
                qrPreview.innerHTML = `
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Generating...</span>
                    </div>
                    <p class="text-muted mt-2">Generating QR code...</p>
                `;

                // Generate QR code
                const canvas = document.createElement('canvas');
                await QRCode.toCanvas(canvas, url, {
                    width: size,
                    margin: 2,
                    color: color,
                    errorCorrectionLevel: errorCorrectionLevel
                });

                // Store QR code for later use
                currentQRCode = canvas;
                allQRCodes[tableNumber] = {
                    canvas: canvas.cloneNode(true),
                    url: url
                };

                // Display QR code
                qrPreview.innerHTML = `
                    <div class="qr-code-container">
                        <h5 class="mb-2">Table ${tableNumber}</h5>
                    </div>
                `;
                qrPreview.querySelector('.qr-code-container').appendChild(canvas);

                // Show actions
                qrActions.style.display = 'flex';

            } catch (error) {
                qrPreview.innerHTML = `
                    <i class="fas fa-exclamation-triangle fa-3x text-danger mb-3"></i>
                    <p class="text-danger">Error generating QR code</p>
                `;
                qrActions.style.display = 'none';
                throw error;
            }
        }

        // Download single QR code
        function downloadQRCode() {
            if (!currentQRCode || !currentTable) {
                alert('Please select a table first');
                return;
            }

            const link = document.createElement('a');
            link.download = `table-${currentTable}-qr-code.png`;
            link.href = currentQRCode.toDataURL();
            link.click();
        }

        // Print single QR code
        function printQRCode() {
            if (!currentQRCode || !currentTable) {
                alert('Please select a table first');
                return;
            }

            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                    <head>
                        <title>Table ${currentTable} QR Code</title>
                        <style>
                            body { 
                                margin: 0; 
                                padding: 20px; 
                                text-align: center; 
                                font-family: Arial, sans-serif; 
                            }
                            .qr-container {
                                border: 2px solid #000;
                                padding: 20px;
                                display: inline-block;
                                margin: 20px;
                            }
                            h1 { margin-bottom: 10px; }
                            .table-info { margin-top: 10px; font-size: 14px; }
                        </style>
                    </head>
                    <body>
                        <div class="qr-container">
                            <h1>UNO Restaurant & Café</h1>
                            <h2>Table ${currentTable}</h2>
                            <img src="${currentQRCode.toDataURL()}" alt="QR Code">
                            <div class="table-info">
                                <p>Scan to view menu and place order</p>
                                <p>${getTableUrl(currentTable)}</p>
                            </div>
                        </div>
                    </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        // Copy QR URL
        function copyQRUrl() {
            if (!currentTable) {
                alert('Please select a table first');
                return;
            }

            const url = getTableUrl(currentTable);
            navigator.clipboard.writeText(url).then(() => {
                alert('URL copied to clipboard!');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('URL copied to clipboard!');
            });
        }

        // Download all QR codes
        async function downloadAllQRCodes() {
            const from = parseInt(document.getElementById('tableFrom').value);
            const to = parseInt(document.getElementById('tableTo').value);

            if (Object.keys(allQRCodes).length === 0) {
                alert('Please generate some QR codes first');
                return;
            }

            // Create a zip file would require additional library
            // For now, download each QR code individually
            for (let i = from; i <= to; i++) {
                if (allQRCodes[i]) {
                    const link = document.createElement('a');
                    link.download = `table-${i}-qr-code.png`;
                    link.href = allQRCodes[i].canvas.toDataURL();
                    link.click();
                    
                    // Small delay between downloads
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
            }
        }

        // Print all QR codes
        function printAllQRCodes() {
            const from = parseInt(document.getElementById('tableFrom').value);
            const to = parseInt(document.getElementById('tableTo').value);

            if (Object.keys(allQRCodes).length === 0) {
                alert('Please generate some QR codes first');
                return;
            }

            const printWindow = window.open('', '_blank');
            let content = `
                <html>
                    <head>
                        <title>UNO Restaurant QR Codes</title>
                        <style>
                            body { 
                                margin: 0; 
                                padding: 20px; 
                                font-family: Arial, sans-serif; 
                            }
                            .qr-container {
                                border: 2px solid #000;
                                padding: 15px;
                                display: inline-block;
                                margin: 10px;
                                text-align: center;
                                page-break-inside: avoid;
                            }
                            .qr-container img {
                                max-width: 200px;
                                height: auto;
                            }
                            h1 { font-size: 16px; margin: 5px 0; }
                            h2 { font-size: 14px; margin: 5px 0; }
                            .table-info { font-size: 10px; margin-top: 5px; }
                            @media print {
                                .qr-container { 
                                    width: 3in; 
                                    height: 3.5in; 
                                }
                            }
                        </style>
                    </head>
                    <body>
            `;

            for (let i = from; i <= to; i++) {
                if (allQRCodes[i]) {
                    content += `
                        <div class="qr-container">
                            <h1>UNO Restaurant & Café</h1>
                            <h2>Table ${i}</h2>
                            <img src="${allQRCodes[i].canvas.toDataURL()}" alt="QR Code">
                            <div class="table-info">
                                <p>Scan to view menu</p>
                            </div>
                        </div>
                    `;
                }
            }

            content += '</body></html>';
            
            printWindow.document.write(content);
            printWindow.document.close();
            printWindow.print();
        }

        // Initialize with default tables
        document.addEventListener('DOMContentLoaded', function() {
            generateTableList();
        });

        // Update QR code when settings change
        document.getElementById('qrSize').addEventListener('change', function() {
            if (currentTable) {
                generateQRCode(getTableUrl(currentTable), currentTable);
            }
        });

        document.getElementById('errorCorrection').addEventListener('change', function() {
            if (currentTable) {
                generateQRCode(getTableUrl(currentTable), currentTable);
            }
        });

        document.getElementById('qrColor').addEventListener('change', function() {
            if (currentTable) {
                generateQRCode(getTableUrl(currentTable), currentTable);
            }
        });

        document.getElementById('qrBackground').addEventListener('change', function() {
            if (currentTable) {
                generateQRCode(getTableUrl(currentTable), currentTable);
            }
        });
    </script>
</body>
</html>

